<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-chapter-8" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Chapter 8: Advanced Features and Subagents | AI Spec Book by Anshara Amir</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://AnsharaAmir.github.io/ai-specbook/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://AnsharaAmir.github.io/ai-specbook/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://AnsharaAmir.github.io/ai-specbook/docs/chapter-8"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Chapter 8: Advanced Features and Subagents | AI Spec Book by Anshara Amir"><meta data-rh="true" name="description" content="So far, our application has been built around a single, powerful AI model. But what happens when a task becomes too complex for a single line of thought? To build truly advanced applications, we need to move from a monolithic mindset to a modular one, employing a team of specialized &quot;subagents&quot; that work together. This chapter introduces the concept of reusable intelligence and showcases how to design a system of collaborating subagents."><meta data-rh="true" property="og:description" content="So far, our application has been built around a single, powerful AI model. But what happens when a task becomes too complex for a single line of thought? To build truly advanced applications, we need to move from a monolithic mindset to a modular one, employing a team of specialized &quot;subagents&quot; that work together. This chapter introduces the concept of reusable intelligence and showcases how to design a system of collaborating subagents."><link data-rh="true" rel="icon" href="/ai-specbook/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://AnsharaAmir.github.io/ai-specbook/docs/chapter-8"><link data-rh="true" rel="alternate" href="https://AnsharaAmir.github.io/ai-specbook/docs/chapter-8" hreflang="en"><link data-rh="true" rel="alternate" href="https://AnsharaAmir.github.io/ai-specbook/docs/chapter-8" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Chapter 8: Advanced Features and Subagents","item":"https://AnsharaAmir.github.io/ai-specbook/docs/chapter-8"}]}</script><link rel="stylesheet" href="/ai-specbook/assets/css/styles.ad3d35f5.css">
<script src="/ai-specbook/assets/js/runtime~main.6f0ac275.js" defer="defer"></script>
<script src="/ai-specbook/assets/js/main.3dbcfd47.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/ai-specbook/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ai-specbook/"><div class="navbar__logo"><img src="/ai-specbook/img/logo.svg" alt="AI Spec Book Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/ai-specbook/img/logo.svg" alt="AI Spec Book Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">AI Spec Book</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/ai-specbook/docs/chapter-1">Chapters</a><a class="navbar__item navbar__link" href="/ai-specbook/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/AnsharaAmir/ai-specbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-specbook/docs/chapter-1"><span title="Chapter 1: Let&#x27;s Build an AI! (The Smart Way)" class="linkLabel_WmDU">Chapter 1: Let&#x27;s Build an AI! (The Smart Way)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-specbook/docs/chapter-2"><span title="Chapter 2: Docusaurus Setup &amp; Markdown Basics" class="linkLabel_WmDU">Chapter 2: Docusaurus Setup &amp; Markdown Basics</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-specbook/docs/chapter-3"><span title="Chapter 3: Writing Your First Spec with Spec-Kit Plus" class="linkLabel_WmDU">Chapter 3: Writing Your First Spec with Spec-Kit Plus</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-specbook/docs/chapter-4"><span title="Chapter 4: Building the RAG Chatbot" class="linkLabel_WmDU">Chapter 4: Building the RAG Chatbot</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-specbook/docs/chapter-5"><span title="Chapter 5: User Authentication and Personalization" class="linkLabel_WmDU">Chapter 5: User Authentication and Personalization</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-specbook/docs/chapter-6"><span title="Chapter 6: Urdu Translation and Multilingual Content" class="linkLabel_WmDU">Chapter 6: Urdu Translation and Multilingual Content</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-specbook/docs/chapter-7"><span title="Chapter 7: Integration and Deployment" class="linkLabel_WmDU">Chapter 7: Integration and Deployment</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/ai-specbook/docs/chapter-8"><span title="Chapter 8: Advanced Features and Subagents" class="linkLabel_WmDU">Chapter 8: Advanced Features and Subagents</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-specbook/docs/chapter-9"><span title="Chapter 9: Final Thoughts and Next Steps" class="linkLabel_WmDU">Chapter 9: Final Thoughts and Next Steps</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/ai-specbook/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Chapter 8: Advanced Features and Subagents</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Chapter 8: Advanced Features and Subagents</h1></header>
<p>So far, our application has been built around a single, powerful AI model. But what happens when a task becomes too complex for a single line of thought? To build truly advanced applications, we need to move from a monolithic mindset to a modular one, employing a team of specialized &quot;subagents&quot; that work together. This chapter introduces the concept of reusable intelligence and showcases how to design a system of collaborating subagents.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="the-principle-of-reusable-intelligence">The Principle of Reusable Intelligence<a href="#the-principle-of-reusable-intelligence" class="hash-link" aria-label="Direct link to The Principle of Reusable Intelligence" title="Direct link to The Principle of Reusable Intelligence" translate="no">​</a></h2>
<p>Reusable intelligence is an architectural pattern where complex problems are broken down and delegated to specialized, independent agents. Instead of one &quot;generalist&quot; agent trying to do everything, you have a team of &quot;specialist&quot; subagents, each an expert in its domain.</p>
<p>A robust way to implement this is with a <strong>Controller-Worker</strong> architecture, much like the one described in the code snippets you&#x27;ve seen.</p>
<ul>
<li class=""><strong>The <code>Task</code></strong>: A <code>Task</code> defines a specific job to be done, like &quot;perform an advanced web search&quot; or &quot;evaluate the credibility of this text.&quot;</li>
<li class=""><strong>The <code>TaskWorker</code></strong>: A <code>TaskWorker</code> is a dedicated agent that knows how to perform a specific <code>Task</code>. It&#x27;s a self-contained unit of intelligence.</li>
<li class=""><strong>The <code>TaskController</code></strong>: The <code>TaskController</code> is the orchestrator. It receives a high-level goal, breaks it down into tasks, and dispatches them to the appropriate available workers. It manages the whole process, collecting results and ensuring the final goal is met.</li>
</ul>
<p>This design gives us incredible flexibility. We can add new capabilities simply by creating new <code>Task</code> and <code>TaskWorker</code> classes, and we can scale our application by running more workers.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">//</span><span class="token plain"> A conceptual look at the TaskController&#x27;s role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">TaskController</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">start_sample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> StartSampleRequest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 1. Identify the task type from the request</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        task_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 2. Find an available worker for that task</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        target_worker </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">find_available_worker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">task_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> target_worker </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">raise</span><span class="token plain"> HTTPException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">406</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Error: No workers available&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 3. Assign the job to the selected worker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_call_worker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            task_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            target_worker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;/start_sample&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> result</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="a-team-of-specialist-subagents">A Team of Specialist Subagents<a href="#a-team-of-specialist-subagents" class="hash-link" aria-label="Direct link to A Team of Specialist Subagents" title="Direct link to A Team of Specialist Subagents" translate="no">​</a></h2>
<p>Let&#x27;s explore some concrete examples of subagents we could build for our application. These are inspired by the powerful classes you&#x27;ve already seen.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-the-advanced-search-subagent">1. The Advanced Search Subagent<a href="#1-the-advanced-search-subagent" class="hash-link" aria-label="Direct link to 1. The Advanced Search Subagent" title="Direct link to 1. The Advanced Search Subagent" translate="no">​</a></h3>
<p>When a simple database lookup isn&#x27;t enough, we need an expert researcher. The <code>AdvancedSearchSystem</code> is a perfect blueprint for this subagent.</p>
<p><strong>Role</strong>: To perform deep, multi-faceted searches to gather comprehensive information on a topic.</p>
<p><strong>Capabilities</strong>:</p>
<ul>
<li class=""><strong>Strategic Searching</strong>: It&#x27;s not just a simple search. It can employ multiple strategies, like <code>&quot;source-based&quot;</code>, <code>&quot;parallel&quot;</code>, or <code>&quot;recursive-decomposition&quot;</code>, depending on the query&#x27;s nature. This is configured during its initialization.</li>
<li class=""><strong>Question Generation</strong>: It can break a broad topic down into a series of specific questions to guide its search, ensuring thorough coverage.</li>
<li class=""><strong>Link and Finding Management</strong>: It keeps track of all sources and findings, creating a well-documented research trail.</li>
</ul>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># A subagent worker based on AdvancedSearchSystem</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AdvancedSearchWorker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Task</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># This worker specializes in source-based search</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">search_system </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> AdvancedSearchSystem</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">strategy_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;source-based&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;advanced_search&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">start_sample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> SampleIndex</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Session</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        query </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> index</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">query </span><span class="token comment" style="color:#999988;font-style:italic"># Assume the query is part of the sample index</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        search_result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">search_system</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">analyze_topic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">query</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Return the structured findings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> TaskSampleExecutionResult</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">search_result</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-the-evidence-evaluator-subagent">2. The Evidence Evaluator Subagent<a href="#2-the-evidence-evaluator-subagent" class="hash-link" aria-label="Direct link to 2. The Evidence Evaluator Subagent" title="Direct link to 2. The Evidence Evaluator Subagent" translate="no">​</a></h3>
<p>Information is useless without trust. Once the search agent has gathered data, we need a skeptic to validate it. The <code>EvidenceEvaluator</code> is designed for this critical role.</p>
<p><strong>Role</strong>: To assess the credibility and relevance of a piece of information against a specific claim or constraint.</p>
<p><strong>Capabilities</strong>:</p>
<ul>
<li class=""><strong>Evidence Extraction</strong>: It can read a block of text and extract a specific <code>CLAIM</code>, its <code>SOURCE</code>, and a <code>CONFIDENCE</code> score.</li>
<li class=""><strong>Type Classification</strong>: It categorizes evidence by type (e.g., <code>OFFICIAL_RECORD</code>, <code>NEWS_REPORT</code>, <code>SPECULATION</code>), which helps in weighing its importance.</li>
<li class=""><strong>Reasoning</strong>: It provides a rationale for its confidence score, making its decisions transparent.</li>
</ul>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># An example of how the EvidenceEvaluator would be used</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">EvidenceEvaluator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">extract_evidence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> search_result</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> candidate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> constraint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Constraint</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Evidence</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        prompt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">Extract evidence regarding whether &quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">candidate</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot; satisfies this constraint:</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">Constraint: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">constraint</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">description</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">Search Results: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">search_result</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># ... parsing logic ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> Evidence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-the-chat-orchestrator-subagent">3. The Chat Orchestrator Subagent<a href="#3-the-chat-orchestrator-subagent" class="hash-link" aria-label="Direct link to 3. The Chat Orchestrator Subagent" title="Direct link to 3. The Chat Orchestrator Subagent" translate="no">​</a></h3>
<p>Some tasks are not single actions but multi-step processes. The <code>AdvancedChatService</code> provides a model for a &quot;meta-agent&quot; or orchestrator that manages a complex conversational workflow.</p>
<p><strong>Role</strong>: To manage the entire lifecycle of a user&#x27;s request, from understanding it to generating, validating, and formatting the final answer.</p>
<p><strong>Capabilities</strong>:</p>
<ul>
<li class=""><strong>Requirement Enhancement</strong>: It first uses an LLM to clarify and enrich the user&#x27;s initial prompt, adding necessary context.</li>
<li class=""><strong>Iterative Refinement</strong>: It can operate in a loop, generating a solution and then passing it to a validator. If the solution is invalid, it uses the feedback to try again.</li>
<li class=""><strong>Multi-Phase Processing</strong>: It breaks the problem down into distinct phases: <strong>Enhance -&gt; Generate -&gt; Validate -&gt; Format</strong>. This structured approach leads to more reliable and higher-quality outputs.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="orchestration-in-action-a-walkthrough">Orchestration in Action: A Walkthrough<a href="#orchestration-in-action-a-walkthrough" class="hash-link" aria-label="Direct link to Orchestration in Action: A Walkthrough" title="Direct link to Orchestration in Action: A Walkthrough" translate="no">​</a></h2>
<p>Imagine a user asks, &quot;What are the most reliable, recently-published Python libraries for asynchronous web scraping, and what are their pros and cons?&quot;</p>
<p>Here&#x27;s how our team of subagents, managed by the <code>TaskController</code>, might handle it:</p>
<ol>
<li class=""><strong>Request Ingestion</strong>: The <code>TaskController</code> receives the request and sees that it&#x27;s a complex conversational query. It assigns the main job to an <code>AdvancedChatService</code> worker.</li>
<li class=""><strong>Enhancement</strong>: The <code>Chat Orchestrator</code> first enhances the query, perhaps clarifying &quot;recently-published&quot; to &quot;published in the last 18 months&quot; and &quot;reliable&quot; to &quot;having good test coverage and active maintenance.&quot;</li>
<li class=""><strong>Delegation to Search</strong>: The orchestrator now needs data. It sends a new task to the <code>TaskController</code>: <code>&quot;advanced_search&quot;</code>, with the query &quot;asynchronous Python web scraping libraries published since late 2024.&quot;</li>
<li class=""><strong>Information Gathering</strong>: The <code>TaskController</code> finds an available <code>AdvancedSearchWorker</code>. This worker executes its source-based strategy, finding blogs, tutorials, and GitHub repositories.</li>
<li class=""><strong>Validation</strong>: For each library found (e.g., &quot;ScrapeFlow,&quot; &quot;AsyncWeb&quot;), the <code>Chat Orchestrator</code> can delegate tasks to an <code>EvidenceEvaluator</code> worker. It asks it to verify claims like &quot;Is ScrapeFlow actively maintained?&quot; using the search results as context.</li>
<li class=""><strong>Synthesis and Generation</strong>: Armed with a validated list of libraries and evidence of their pros and cons, the <code>Chat Orchestrator</code> synthesizes all the information. It constructs a final, detailed prompt for the <code>GeminiModel</code>.</li>
<li class=""><strong>Final Response</strong>: The <code>GeminiModel</code> generates a well-structured answer comparing the libraries. The <code>Chat Orchestrator</code> performs a final formatting pass and returns the result to the user.</li>
</ol>
<p>This modular, collaborative approach allows us to build far more capable and robust AI systems than we could with a single agent.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="whats-next">What&#x27;s Next?<a href="#whats-next" class="hash-link" aria-label="Direct link to What&#x27;s Next?" title="Direct link to What&#x27;s Next?" translate="no">​</a></h2>
<p>This chapter concludes our primary journey through spec-driven development and advanced AI application design. You are now equipped with the principles and patterns to build sophisticated, modular, and intelligent systems. The path forward is one of continuous learning, experimentation, and refinement. Happy building!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/AnsharaAmir/ai-specbook/tree/main/docs/chapter-8.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/ai-specbook/docs/chapter-7"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Chapter 7: Integration and Deployment</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ai-specbook/docs/chapter-9"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Chapter 9: Final Thoughts and Next Steps</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-principle-of-reusable-intelligence" class="table-of-contents__link toc-highlight">The Principle of Reusable Intelligence</a></li><li><a href="#a-team-of-specialist-subagents" class="table-of-contents__link toc-highlight">A Team of Specialist Subagents</a><ul><li><a href="#1-the-advanced-search-subagent" class="table-of-contents__link toc-highlight">1. The Advanced Search Subagent</a></li><li><a href="#2-the-evidence-evaluator-subagent" class="table-of-contents__link toc-highlight">2. The Evidence Evaluator Subagent</a></li><li><a href="#3-the-chat-orchestrator-subagent" class="table-of-contents__link toc-highlight">3. The Chat Orchestrator Subagent</a></li></ul></li><li><a href="#orchestration-in-action-a-walkthrough" class="table-of-contents__link toc-highlight">Orchestration in Action: A Walkthrough</a></li><li><a href="#whats-next" class="table-of-contents__link toc-highlight">What&#39;s Next?</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/ai-specbook/docs/intro">Chapters</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/ai-specbook/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/AnsharaAmir/ai-specbook" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Anshara Amir. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>